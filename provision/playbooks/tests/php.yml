---
- name: Test | PHP is installed
  shell: php -v
  always_run: yes
  tags: test

- name: Test | Get PHP-FPM service status
  shell: service php5-fpm status
  always_run: yes
  register: fpm_status
  ignore_errors: true
  tags: test
  sudo: true

- name: Test | PHP-FPM is running
  fail: msg="PHP-FPM is not running."
  when: fpm_status.stdout.find('running') == -1
  tags: test

- name: Test | Composer is installed
  shell: composer
  always_run: yes
  tags: test
